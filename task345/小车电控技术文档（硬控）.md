## 一、整体概述

电控系统以**STM32F103C8T6最小系统板**为主控，通过**C8T6最小系统板 IO扩展板**引出所需引脚，使用**12V-5V降压模块**、**L298N电机驱动模块**、**JDY-31蓝牙模块**、**步进电机**、**SG90舵机**，实现对舵机、步进电机的角度和步进电机的速度的远程控制。

## 二、模块选择及接线

### 控制核心

* **主控模块**：STM32F103C8T6最小系统板+IO扩展板，无需单独设计晶振等电路，且便于杜邦线接外设的连接与调试。

### 供电模块：使用12V-5V降压模块接12V锂电池提供5V电源，满足主控、蓝牙、舵机、电机的供电需求；SS12D10G5作为电源总开关便于操作，避免电池插拔的问题。

### 动力驱动

* **驱动模块及执行器**：L298N电机驱动模块（H桥驱动双路）+TT直流电机×4
* **接线及引脚**：1、为了让同侧电机朝相同方向转动，按左右方向分为两组采用并联的方式连接电机，其中右侧的电机并联后接L298N的输出A（OUT1、OUT2），左侧接输出B（OUT3、OUT4）；2、将A1作为控制端，利用其高低电平和PWM的输出功能；3、使能口（接PWM输出引脚，控制电机速度，包括ENA和ENB）和逻辑输入口（接主控 GPIO 引脚，控制电机正反转），具体逻辑如下：(以ENA、IN1、IN2为例，ENB、IN1、IN2逻辑与之相同)

|ENA|IN1|IN2|电机状态|
|-|-|-|-|
|0|X|X|停止|
|1|0|0|制动|
|1|0|1|正转|
|1|1|0|反转|
|1|1|1|制动|

### 无线通信

* **模块型号**:JDY-31蓝牙模块
* **串口调试**：首先将JDY-31和USB转TTL连接（TXD--RXD、RXD--TXD、GND--GND、5V--VCC）后接到电脑USB口，用串口调试工具将波特率调整到9600并查看配对密码
* **接线及供电**：1、STM32--JDY-31（A9--RXD/A10--TXD），由于JDY-31为USART串口的模块，利用STM上对应的专用IO口A9\\A10实现无线通信；2、同时JDY-31需要与单片机共地，并使用5V供电，这里同样用降压模块将电池12V降到5V进行供电；3、与电机模块分开走线避免干扰。
* **远程控制**：通过手机蓝牙APP实现，在代码编写之后，使用蓝牙APP连接到JDY-31,发送设定好的参数即可远程对小车做出控制（包括舵机的控制）。

### 云台设备

* **模块型号**：SG90舵机×1
* **供电**：与前述模块相同，通过降压模块得到稳定的5V电源供电，满足舵机较大的功率，避免供电不足。
* **接线**：VCC接5V降压模块，GND接公共地，PWM信号端接主控专用 PWM 输出引脚（A3），与电机的走线分开避免电流干扰

## 三、远程控制的逻辑

### 1、通过手机蓝牙APP发送设定的指令，无线信号传至JDY-31模块；2、信号转为USART信号传到主控；3、主控接收并解析数据，得到具体的参数；4、根据参数，通过对应GPIO/PWM引脚输出控制信号，向SG90舵机输出指定占空比的PWM信号，调节转向角度；向L298N驱动板输出高低电平/ PWM 信号，控制电机正反转与调速；5、L298N驱动小车运动

